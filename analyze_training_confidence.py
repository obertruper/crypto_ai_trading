"""ÐÐ½Ð°Ð»Ð¸Ð· ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð»Ð¾Ð³Ð¾Ð² Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ"""

print("ðŸ” ÐÐÐÐ›Ð˜Ð— Ð£Ð’Ð•Ð Ð•ÐÐÐžÐ¡Ð¢Ð˜ ÐœÐžÐ”Ð•Ð›Ð˜ (Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ð¿Ð¾ÑÐ»ÐµÐ´Ð½ÐµÐ³Ð¾ Ð¾Ð±ÑƒÑ‡ÐµÐ½Ð¸Ñ)")
print("="*60)

# Ð”Ð°Ð½Ð½Ñ‹Ðµ Ð¸Ð· Ð¿Ð¾ÑÐ»ÐµÐ´Ð½Ð¸Ñ… Ð»Ð¾Ð³Ð¾Ð²
entropy = 0.811
predictions = {
    'LONG': 9.3,
    'SHORT': 11.1,
    'FLAT': 79.6
}
true_dist = {
    'LONG': 37.7,
    'SHORT': 37.0,
    'FLAT': 25.4
}

print("\nðŸ“Š Ð ÐÐ¡ÐŸÐ Ð•Ð”Ð•Ð›Ð•ÐÐ˜Ð• ÐŸÐ Ð•Ð”Ð¡ÐšÐÐ—ÐÐÐ˜Ð™:")
print(f"LONG:  {predictions['LONG']}% (Ð¸ÑÑ‚Ð¸Ð½Ð½Ð¾Ðµ: {true_dist['LONG']}%)")
print(f"SHORT: {predictions['SHORT']}% (Ð¸ÑÑ‚Ð¸Ð½Ð½Ð¾Ðµ: {true_dist['SHORT']}%)")
print(f"FLAT:  {predictions['FLAT']}% (Ð¸ÑÑ‚Ð¸Ð½Ð½Ð¾Ðµ: {true_dist['FLAT']}%)")

print(f"\nðŸŽ² Ð­ÐÐ¢Ð ÐžÐŸÐ˜Ð¯: {entropy:.3f}")
print("(0 = Ð¿Ð¾Ð»Ð½Ð°Ñ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð² Ð¾Ð´Ð½Ð¾Ð¼ ÐºÐ»Ð°ÑÑÐµ, 1.099 = Ñ€Ð°Ð²Ð½Ð¾Ð¼ÐµÑ€Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ)")

# ÐÐ½Ð°Ð»Ð¸Ð· ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð½Ð° Ð¾ÑÐ½Ð¾Ð²Ðµ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ñ
max_pred = max(predictions.values())
min_pred = min(predictions.values())
spread = max_pred - min_pred

print("\nðŸ’¡ ÐÐÐÐ›Ð˜Ð— Ð£Ð’Ð•Ð Ð•ÐÐÐžÐ¡Ð¢Ð˜:")

# ÐžÑ†ÐµÐ½ÐºÐ° ÑÑ€ÐµÐ´Ð½ÐµÐ³Ð¾ ÑƒÑ€Ð¾Ð²Ð½Ñ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸
# Ð•ÑÐ»Ð¸ Ð¼Ð¾Ð´ÐµÐ»ÑŒ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ 79.6% FLAT, ÑÑ‚Ð¾ Ð¾Ð·Ð½Ð°Ñ‡Ð°ÐµÑ‚ Ð²Ñ‹ÑÐ¾ÐºÑƒÑŽ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð² FLAT
avg_confidence_flat = predictions['FLAT'] / 100
avg_confidence_long = predictions['LONG'] / 100 * 3  # ÐšÐ¾Ñ€Ñ€ÐµÐºÑ‚Ð¸Ñ€Ð¾Ð²ÐºÐ° Ñ‚.Ðº. Ð¼Ð°Ð»Ð¾ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¹
avg_confidence_short = predictions['SHORT'] / 100 * 3

print(f"\nÐžÑ†ÐµÐ½Ð¾Ñ‡Ð½Ð°Ñ ÑÑ€ÐµÐ´Ð½ÑÑ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾ ÐºÐ»Ð°ÑÑÐ°Ð¼:")
print(f"- ÐŸÑ€Ð¸ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¸ FLAT: ~{avg_confidence_flat:.1%}")
print(f"- ÐŸÑ€Ð¸ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¸ LONG: ~{avg_confidence_long:.1%}")
print(f"- ÐŸÑ€Ð¸ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¸ SHORT: ~{avg_confidence_short:.1%}")

# ÐŸÑ€Ð¾Ð±Ð»ÐµÐ¼Ñ‹ Ñ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒÑŽ
print("\nâš ï¸ Ð’Ð«Ð¯Ð’Ð›Ð•ÐÐÐ«Ð• ÐŸÐ ÐžÐ‘Ð›Ð•ÐœÐ«:")

if predictions['FLAT'] > 70:
    print("1. Ð§Ð Ð•Ð—ÐœÐ•Ð ÐÐÐ¯ Ð£Ð’Ð•Ð Ð•ÐÐÐžÐ¡Ð¢Ð¬ Ð’ FLAT:")
    print(f"   - ÐœÐ¾Ð´ÐµÐ»ÑŒ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ FLAT Ð² {predictions['FLAT']}% ÑÐ»ÑƒÑ‡Ð°ÐµÐ²")
    print("   - Ð­Ñ‚Ð¾ ÑƒÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ð½Ð° Ñ‚Ð¾, Ñ‡Ñ‚Ð¾ Ð¼Ð¾Ð´ÐµÐ»ÑŒ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ ÑƒÐ²ÐµÑ€ÐµÐ½Ð° Ð² Ð¾Ñ‚ÑÑƒÑ‚ÑÑ‚Ð²Ð¸Ð¸ Ð´Ð²Ð¸Ð¶ÐµÐ½Ð¸Ñ")
    print("   - Ð’ÐµÑ€Ð¾ÑÑ‚Ð½Ð°Ñ ÑÑ€ÐµÐ´Ð½ÑÑ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð² FLAT: >80%")

if predictions['LONG'] < 15 and predictions['SHORT'] < 15:
    print("\n2. ÐÐ˜Ð—ÐšÐÐ¯ Ð£Ð’Ð•Ð Ð•ÐÐÐžÐ¡Ð¢Ð¬ Ð’ Ð¢ÐžÐ Ð“ÐžÐ’Ð«Ð¥ Ð¡Ð˜Ð“ÐÐÐ›ÐÐ¥:")
    print(f"   - LONG Ð²ÑÐµÐ³Ð¾ {predictions['LONG']}%, SHORT Ð²ÑÐµÐ³Ð¾ {predictions['SHORT']}%")
    print("   - ÐœÐ¾Ð´ÐµÐ»ÑŒ Ð½ÐµÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ñ‹Ð²Ð°ÐµÑ‚ Ñ‚Ð¾Ñ€Ð³Ð¾Ð²Ñ‹Ðµ ÑÐ¸Ð³Ð½Ð°Ð»Ñ‹")
    print("   - Ð’ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾, Ð¿Ð¾Ñ€Ð¾Ð³ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð´Ð»Ñ LONG/SHORT ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð²Ñ‹ÑÐ¾Ðº")

# ÐšÐ°Ð»Ð¸Ð±Ñ€Ð¾Ð²ÐºÐ°
calibration_error = abs(predictions['FLAT'] - true_dist['FLAT'])
print(f"\n3. ÐŸÐ›ÐžÐ¥ÐÐ¯ ÐšÐÐ›Ð˜Ð‘Ð ÐžÐ’ÐšÐ:")
print(f"   - ÐžÑˆÐ¸Ð±ÐºÐ° ÐºÐ°Ð»Ð¸Ð±Ñ€Ð¾Ð²ÐºÐ¸ Ð´Ð»Ñ FLAT: {calibration_error:.1f}%")
print("   - ÐœÐ¾Ð´ÐµÐ»ÑŒ Ð¿ÐµÑ€ÐµÐ¾Ñ†ÐµÐ½Ð¸Ð²Ð°ÐµÑ‚ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÑŒ FLAT Ð² 3 Ñ€Ð°Ð·Ð°!")

# Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´Ð°Ñ†Ð¸Ð¸
print("\nðŸŽ¯ Ð Ð•ÐšÐžÐœÐ•ÐÐ”ÐÐ¦Ð˜Ð˜:")

print("\n1. Ð¡ÐÐ˜Ð—Ð˜Ð¢Ð¬ ÐŸÐžÐ ÐžÐ“ Ð£Ð’Ð•Ð Ð•ÐÐÐžÐ¡Ð¢Ð˜:")
print("   - Ð¢ÐµÐºÑƒÑ‰Ð¸Ð¹ confidence_threshold: 0.6 (60%)")
print("   - Ð ÐµÐºÐ¾Ð¼ÐµÐ½Ð´ÑƒÐµÑ‚ÑÑ ÑÐ½Ð¸Ð·Ð¸Ñ‚ÑŒ Ð´Ð¾ 0.4-0.45")
print("   - Ð­Ñ‚Ð¾ Ð¿Ð¾Ð·Ð²Ð¾Ð»Ð¸Ñ‚ Ð¼Ð¾Ð´ÐµÐ»Ð¸ Ñ‡Ð°Ñ‰Ðµ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ñ‹Ð²Ð°Ñ‚ÑŒ LONG/SHORT")

print("\n2. Ð˜Ð¡ÐŸÐžÐ›Ð¬Ð—ÐžÐ’ÐÐ¢Ð¬ TEMPERATURE SCALING:")
print("   - Ð”Ð¾Ð±Ð°Ð²Ð¸Ñ‚ÑŒ Ñ‚ÐµÐ¼Ð¿ÐµÑ€Ð°Ñ‚ÑƒÑ€Ñƒ T=2.0 Ð´Ð»Ñ softmax")
print("   - Ð­Ñ‚Ð¾ ÑÐ´ÐµÐ»Ð°ÐµÑ‚ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ Ð²ÐµÑ€Ð¾ÑÑ‚Ð½Ð¾ÑÑ‚ÐµÐ¹ Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°Ð²Ð½Ð¾Ð¼ÐµÑ€Ð½Ñ‹Ð¼")
print("   - Ð¡Ð½Ð¸Ð·Ð¸Ñ‚ Ñ‡Ñ€ÐµÐ·Ð¼ÐµÑ€Ð½ÑƒÑŽ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚ÑŒ Ð² FLAT")

print("\n3. Ð”ÐžÐ‘ÐÐ’Ð˜Ð¢Ð¬ ENTROPY REGULARIZATION:")
print("   - Ð¨Ñ‚Ñ€Ð°Ñ„Ð¾Ð²Ð°Ñ‚ÑŒ ÑÐ»Ð¸ÑˆÐºÐ¾Ð¼ Ð½Ð¸Ð·ÐºÑƒÑŽ ÑÐ½Ñ‚Ñ€Ð¾Ð¿Ð¸ÑŽ Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¹")
print("   - ÐŸÐ¾Ð¾Ñ‰Ñ€ÑÑ‚ÑŒ Ð±Ð¾Ð»ÐµÐµ Ñ€Ð°Ð²Ð½Ð¾Ð¼ÐµÑ€Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸")

print("\n4. Ð˜Ð—ÐœÐ•ÐÐ˜Ð¢Ð¬ Ð˜ÐÐ˜Ð¦Ð˜ÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð® BIAS:")
print("   - Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ bias direction_head Ñ Ð¿Ñ€ÐµÐ´Ð¿Ð¾Ñ‡Ñ‚ÐµÐ½Ð¸ÐµÐ¼ LONG/SHORT")
print("   - Ð­Ñ‚Ð¾ Ð¿Ð¾Ð¼Ð¾Ð¶ÐµÑ‚ Ð¸Ð·Ð±ÐµÐ¶Ð°Ñ‚ÑŒ ÑÑ…Ð»Ð¾Ð¿Ñ‹Ð²Ð°Ð½Ð¸Ñ Ð² FLAT Ñ ÑÐ°Ð¼Ð¾Ð³Ð¾ Ð½Ð°Ñ‡Ð°Ð»Ð°")

# Ð’Ð¸Ð·ÑƒÐ°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ
print("\nðŸ“Š Ð’Ð˜Ð—Ð£ÐÐ›Ð˜Ð—ÐÐ¦Ð˜Ð¯ Ð”Ð˜Ð¡Ð‘ÐÐ›ÐÐÐ¡Ð:")
print("\nÐ˜ÑÑ‚Ð¸Ð½Ð½Ð¾Ðµ Ñ€Ð°ÑÐ¿Ñ€ÐµÐ´ÐµÐ»ÐµÐ½Ð¸Ðµ:")
for cls, pct in true_dist.items():
    bar = 'â–ˆ' * int(pct/2)
    print(f"{cls:5}: {bar} {pct}%")

print("\nÐŸÑ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ñ Ð¼Ð¾Ð´ÐµÐ»Ð¸:")
for cls, pct in predictions.items():
    bar = 'â–ˆ' * int(pct/2)
    print(f"{cls:5}: {bar} {pct}%")

print("\nðŸ”´ Ð’Ð«Ð’ÐžÐ”: ÐœÐ¾Ð´ÐµÐ»ÑŒ Ð¡Ð›Ð˜Ð¨ÐšÐžÐœ Ð£Ð’Ð•Ð Ð•ÐÐ Ð² Ð¿Ñ€ÐµÐ´ÑÐºÐ°Ð·Ð°Ð½Ð¸Ð¸ FLAT!")
print("ÐÐµÐ¾Ð±Ñ…Ð¾Ð´Ð¸Ð¼Ð¾ ÑÐ½Ð¸Ð·Ð¸Ñ‚ÑŒ Ð¿Ð¾Ñ€Ð¾Ð³ ÑƒÐ²ÐµÑ€ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð¸ Ð¿Ñ€Ð¸Ð¼ÐµÐ½Ð¸Ñ‚ÑŒ temperature scaling.")