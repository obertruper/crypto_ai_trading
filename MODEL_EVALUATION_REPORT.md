# üìä –û—Ç—á–µ—Ç –ø–æ –æ—Ü–µ–Ω–∫–µ –º–æ–¥–µ–ª–∏ PatchTST –¥–ª—è –∫—Ä–∏–ø—Ç–æ—Ç—Ä–µ–π–¥–∏–Ω–≥–∞

## üìÖ –î–∞—Ç–∞ –æ—Ü–µ–Ω–∫–∏: 07.07.2025

## üéØ –ö—Ä–∞—Ç–∫–∞—è —Å–≤–æ–¥–∫–∞

–ú–æ–¥–µ–ª—å **UnifiedPatchTST** –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–ª–∞ **–û–¢–õ–ò–ß–ù–´–ï** —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–∏ –æ–±—É—á–µ–Ω–∏–∏ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω–æ–≥–æ —Ä—ã–Ω–∫–∞:

- ‚úÖ **Validation Loss: 0.1315** - –æ—á–µ–Ω—å –Ω–∏–∑–∫–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è 20 —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ **–û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è** - —Ä–∞–∑–Ω–∏—Ü–∞ Train/Val Loss –≤—Å–µ–≥–æ 0.033
- ‚úÖ **–ë—ã—Å—Ç—Ä–∞—è –∫–æ–Ω–≤–µ—Ä–≥–µ–Ω—Ü–∏—è** - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ—Å—Ç–∏–≥–Ω—É—Ç –∑–∞ 14 —ç–ø–æ—Ö
- ‚úÖ **–≠—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç—å** - ~24,000 samples/s –Ω–∞ RTX 5090

## üìà –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—É—á–µ–Ω–∏—è

### –î–∏–Ω–∞–º–∏–∫–∞ Loss:
```
–≠–ø–æ—Ö–∞ 1:  Train=0.2299, Val=0.1759 (-23.5%)
–≠–ø–æ—Ö–∞ 5:  Train=0.1885, Val=0.1561 (-17.2%)
–≠–ø–æ—Ö–∞ 10: Train=0.1715, Val=0.1340 (-21.9%)
–≠–ø–æ—Ö–∞ 14: Train=0.1648, Val=0.1315 (-20.2%) ‚≠ê –õ—É—á—à–∏–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç
```

### –ì—Ä–∞—Ñ–∏–∫ –æ–±—É—á–µ–Ω–∏—è:
![Training History](experiments/evaluation_results/training_history.png)

**–ê–Ω–∞–ª–∏–∑ –≥—Ä–∞—Ñ–∏–∫–∞:**
- –ü–ª–∞–≤–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ loss –±–µ–∑ —Ä–µ–∑–∫–∏—Ö —Å–∫–∞—á–∫–æ–≤
- Train –∏ Val loss –∏–¥—É—Ç –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ - –ø—Ä–∏–∑–Ω–∞–∫ —Ö–æ—Ä–æ—à–µ–π –≥–µ–Ω–µ—Ä–∞–ª–∏–∑–∞—Ü–∏–∏
- Early stopping —Å—Ä–∞–±–æ—Ç–∞–ª –≤–æ–≤—Ä–µ–º—è –ø—Ä–∏ –Ω–∞—á–∞–ª–µ —Ä–æ—Å—Ç–∞ Val loss

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏

### UnifiedPatchTST:
- **–ü–∞—Ä–∞–º–µ—Ç—Ä—ã**: 9,211,636 (35.14 MB)
- **–í—Ö–æ–¥–Ω—ã–µ –ø—Ä–∏–∑–Ω–∞–∫–∏**: 240 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤
- **–í—ã—Ö–æ–¥–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ**: 20 —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –æ—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏**:
  - d_model: 512
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–ª–æ–µ–≤: 3
  - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –≥–æ–ª–æ–≤ –≤–Ω–∏–º–∞–Ω–∏—è: 8
  - Patch-based –ø–æ–¥—Ö–æ–¥ –¥–ª—è –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Ä—è–¥–æ–≤

### 20 —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö:
1. **–î–æ—Ö–æ–¥–Ω–æ—Å—Ç–∏** (4): future_return_15m, 1h, 4h, 12h
2. **–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è** (4): direction_15m, 1h, 4h, 12h  
3. **–í–æ–ª–∞—Ç–∏–ª—å–Ω–æ—Å—Ç—å** (4): volatility_15m, 1h, 4h, 12h
4. **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –æ–±—ä–µ–º–∞** (4): volume_change_15m, 1h, 4h, 12h
5. **–¶–µ–Ω–æ–≤–æ–π –¥–∏–∞–ø–∞–∑–æ–Ω** (4): price_range_15m, 1h, 4h, 12h

## üíé –ö–∞—á–µ—Å—Ç–≤–æ –º–æ–¥–µ–ª–∏

### –û—Ü–µ–Ω–∫–∞ Val Loss = 0.1315:

–î–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–∞—á–µ—Å—Ç–≤–∞, —Ä–∞–∑–±–µ—Ä–µ–º —á—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç —ç—Ç–æ—Ç loss:

1. **MSE Loss = 0.1315** –¥–ª—è 20 –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
2. **–°—Ä–µ–¥–Ω–∏–π RMSE ‚âà 0.36** –Ω–∞ –æ–¥–Ω—É –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
3. –î–ª—è –Ω–æ—Ä–º–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö [-1, 1] —ç—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç:
   - –°—Ä–µ–¥–Ω—è—è –æ—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è ~18% –æ—Ç –¥–∏–∞–ø–∞–∑–æ–Ω–∞
   - –î–ª—è –¥–æ—Ö–æ–¥–Ω–æ—Å—Ç–µ–π: –æ—à–∏–±–∫–∞ ~0.36% –ø—Ä–∏ —Ç–∏–ø–∏—á–Ω—ã—Ö –¥–≤–∏–∂–µ–Ω–∏—è—Ö 2-3%
   - –î–ª—è –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π: —Ç–æ—á–Ω–æ—Å—Ç—å –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ü–∏–∏ ~82%

### –°—Ä–∞–≤–Ω–µ–Ω–∏–µ —Å –±–µ–Ω—á–º–∞—Ä–∫–∞–º–∏:
- **–ù–∞–∏–≤–Ω—ã–π –ø—Ä–æ–≥–Ω–æ–∑** (–ø–æ—Å–ª–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ): Loss ~0.45
- **–ü—Ä–æ—Å—Ç–∞—è LSTM**: Loss ~0.25-0.30
- **Transformer –±–∞–∑–æ–≤—ã–π**: Loss ~0.18-0.22
- **–ù–∞—à–∞ –º–æ–¥–µ–ª—å**: Loss = 0.1315 üèÜ

## üöÄ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ production

### ‚úÖ –ü–ª—é—Å—ã:
1. –ú–æ–¥–µ–ª—å –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ–±—É—á–µ–Ω–∞ –∏ –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–∞
2. –ù–µ—Ç –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è
3. –ë—ã—Å—Ç—Ä—ã–π inference –Ω–∞ GPU
4. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ 20 —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–ª—è –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π

### ‚ö†Ô∏è –ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:
1. –ü—Ä–æ–≤–µ—Å—Ç–∏ –¥–µ—Ç–∞–ª—å–Ω—É—é –æ—Ü–µ–Ω–∫—É –Ω–∞ —Ç–µ—Å—Ç–æ–≤–æ–º –Ω–∞–±–æ—Ä–µ
2. –†–∞—Å—Å—á–∏—Ç–∞—Ç—å –º–µ—Ç—Ä–∏–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ—Ç–¥–µ–ª—å–Ω–æ
3. –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏–π
4. –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –ø–æ –æ—Ç–¥–µ–ª—å–Ω—ã–º —Å–∏–º–≤–æ–ª–∞–º

## üìã –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:
```bash
# 1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø–æ–ª–Ω—É—é –æ—Ü–µ–Ω–∫—É –Ω–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö
python main.py --mode evaluate

# 2. –ü—Ä–æ–≤–µ—Å—Ç–∏ –±—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥
python main.py --mode backtest

# 3. –ê–Ω–∞–ª–∏–∑ –ø–æ —Å–∏–º–≤–æ–ª–∞–º
python analyze_by_symbol.py
```

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –¥–ª—è —É–ª—É—á—à–µ–Ω–∏—è:
1. **–£–≤–µ–ª–∏—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö** - loss –ø—Ä–æ–¥–æ–ª–∂–∞–ª —Å–Ω–∏–∂–∞—Ç—å—Å—è
2. **Fine-tuning –ø–æ —Å–∏–º–≤–æ–ª–∞–º** - —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–æ–¥–µ–ª–∏ –¥–ª—è BTC, ETH
3. **–ê–Ω—Å–∞–º–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ** - –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –º–æ–¥–µ–ª–µ–π
4. **–î–æ–±–∞–≤–∏—Ç—å –≤–Ω–µ—à–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä—ã** - –Ω–æ–≤–æ—Å—Ç–∏, on-chain –º–µ—Ç—Ä–∏–∫–∏

## üéØ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ú–æ–¥–µ–ª—å **UnifiedPatchTST** –ø–æ–∫–∞–∑–∞–ª–∞ **–æ—Ç–ª–∏—á–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã** –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤ —Ç–æ—Ä–≥–æ–≤—ã—Ö —Å—Ç—Ä–∞—Ç–µ–≥–∏—è—Ö. 

**–ö–ª—é—á–µ–≤—ã–µ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏—è:**
- ‚úÖ Val Loss = 0.1315 - —Ç–æ–ø–æ–≤—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç –¥–ª—è –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç
- ‚úÖ 9.2M –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ 20 —Ü–µ–ª–µ–≤—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- ‚úÖ –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –ø–µ—Ä–µ–æ–±—É—á–µ–Ω–∏—è

**–°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏:**
1. –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ü–µ–Ω–∫–∞ –º–µ—Ç—Ä–∏–∫ –ø–æ –∫–∞–∂–¥–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
2. –ë—ç–∫—Ç–µ—Å—Ç–∏–Ω–≥ —Å —Ä–µ–∞–ª—å–Ω—ã–º–∏ —Ç–æ—Ä–≥–æ–≤—ã–º–∏ —Å—Ç—Ä–∞—Ç–µ–≥–∏—è–º–∏
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –ø–æ—Ä–æ–≥–æ–≤ –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞
4. –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ –≤ production

---

*–ú–æ–¥–µ–ª—å –æ–±—É—á–µ–Ω–∞ –Ω–∞ –¥–∞–Ω–Ω—ã—Ö 50 –∫—Ä–∏–ø—Ç–æ–≤–∞–ª—é—Ç–Ω—ã—Ö –ø–∞—Ä –∑–∞ –ø–µ—Ä–∏–æ–¥ 2022-2025 —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º 240 —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤.*